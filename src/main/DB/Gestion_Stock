-- Check if the database 'GestionStock' exists
IF DB_ID('GestionStock') IS NULL
BEGIN
    -- Create the database
    CREATE DATABASE [GestionStock]
    CONTAINMENT = NONE
    ON  PRIMARY
    ( NAME = N'GestionStock', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL16.SQLEXPRESS\MSSQL\DATA\GestionStock.mdf' , SIZE = 8192KB , MAXSIZE = UNLIMITED, FILEGROWTH = 65536KB )
    LOG ON
    ( NAME = N'GestionStock_log', FILENAME = N'C:\Program Files\Microsoft SQL Server\MSSQL16.SQLEXPRESS\MSSQL\DATA\GestionStock_log.ldf' , SIZE = 8192KB , MAXSIZE = 2048GB , FILEGROWTH = 65536KB )
    WITH CATALOG_COLLATION = DATABASE_DEFAULT;
    PRINT 'Database GestionStock created';
END
ELSE
BEGIN
    PRINT 'Database GestionStock already exists';
END;
GO

-- Switch to the 'GestionStock' database
USE GestionStock;
GO

-- Check if the 'Clients' table exists
IF OBJECT_ID('dbo.Clients', 'U') IS NULL
BEGIN
    -- Create Clients table
    CREATE TABLE [dbo].[Clients] (
        [Id_client] INT PRIMARY KEY IDENTITY(1,1),
        [Name_client] NVARCHAR(255),
        [Name_product] NVARCHAR(255),
        [Price_clinet] DECIMAL(18, 2),
        [Description] NVARCHAR(MAX)
    );
    PRINT 'Table Clients created';
END
ELSE
BEGIN
    PRINT 'Table Clients already exists';
END;
GO

-- Check if the 'Products' table exists
IF OBJECT_ID('dbo.Products', 'U') IS NULL
BEGIN
    -- Create Products table
    CREATE TABLE [dbo].[Products] (
        [Id_product] INT PRIMARY KEY IDENTITY(1,1),
        [Name_product] NVARCHAR(255),
        [Old_price] DECIMAL(18, 2),
        [New_price] DECIMAL(18, 2),
        [Color] NVARCHAR(50),
        [Quantity] INT,
        [Q_bar] NVARCHAR(50)
    );
    PRINT 'Table Products created';
END
ELSE
BEGIN
    PRINT 'Table Products already exists';
END;
GO

-- Check if the 'Sales' table exists
IF OBJECT_ID('dbo.Sales', 'U') IS NULL
BEGIN
    -- Create Sales table
    CREATE TABLE [dbo].[Sales] (
        [Id_Sales] INT PRIMARY KEY IDENTITY(1,1),
        [Id_product] INT,
        [Name_product] NVARCHAR(255),
        [Quantity] INT,
        [Q_bar] NVARCHAR(50),
        [Price] DECIMAL(18, 2),
        FOREIGN KEY (Id_product) REFERENCES Products(Id_product)
    );
    PRINT 'Table Sales created';
END
ELSE
BEGIN
    PRINT 'Table Sales already exists';
END;
GO

-- Check if the 'Suppliers' table exists
IF OBJECT_ID('dbo.Suppliers', 'U') IS NULL
BEGIN
    -- Create Suppliers table
    CREATE TABLE [dbo].[Suppliers] (
        [Id_suppliers] INT PRIMARY KEY IDENTITY(1,1),
        [Name_suppliers] NVARCHAR(255),
        [Name_Product] NVARCHAR(255),
        [Quantity_suppliers] INT,
        [Price] DECIMAL(18, 2),
        [Description] NVARCHAR(MAX)
    );
    PRINT 'Table Suppliers created';
END
ELSE
BEGIN
    PRINT 'Table Suppliers already exists';
END;
GO
